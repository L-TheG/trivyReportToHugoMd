// Final type after all data transformation
// No more deep nesting
export type Vulnerability = {
  Kind: string;
  Name: string;
  Namespace: string;
  Class: string;
  Target: string;
  Type: string;
  VulnerabilityID: string;
  Title: string;
  SeveritySource: string;
  Severity: string;
  References: string[];
  PublishDate: string;
  PrimaryURL: string;
  PkgName: string;
  Layer: {
    Digest: string;
    DiffID: string;
  };
  LastModifiedDate: string;
  InstalledVersion: string;
  FixedVersion: string;
  Description: string;
  Datasource: {
    ID: string;
    Name: string;
    URL: string;
  };
  CweIDs: string[];
  CVSS: {
    nvd: {
      V2Score: number;
      V2Vector: string;
      V3Score: number;
      V3Vector: string;
    };
    redhat: { V3Score: number; V3Vector: string };
  };
};

// Raw data as received by trivy
// too many arrays and too deeply nested to work with
export type VulnerabilityScannedComponent = {
  Kind: string;
  Name: string;
  Namespace: string;
  Results?: [
    {
      Class: string;
      Target: string;
      Type: string;
      Vulnerabilities?: [
        {
          VulnerabilityID: string;
          Title: string;
          SeveritySource: string;
          Severity: string;
          References: string[];
          PublishDate: string;
          PrimaryURL: string;
          PkgName: string;
          Layer: {
            Digest: string;
            DiffID: string;
          };
          LastModifiedDate: string;
          InstalledVersion: string;
          FixedVersion: string;
          Description: string;
          Datasource: {
            ID: string;
            Name: string;
            URL: string;
          };
          CweIDs: string[];
          CVSS: {
            nvd: {
              V2Score: number;
              V2Vector: string;
              V3Score: number;
              V3Vector: string;
            };
            redhat: { V3Score: number; V3Vector: string };
          };
        }
      ];
    }
  ];
};

// Temporary type, used during data transformation
// Hoisting the results fields into the top most level
// removing one layer of nesting
export type MergedVulnerabilityComponentResult = {
  Kind: string;
  Name: string;
  Namespace: string;
  Class: string;
  Target: string;
  Type: string;
  Vulnerabilities?: [
    {
      VulnerabilityID: string;
      Title: string;
      SeveritySource: string;
      Severity: string;
      References: string[];
      PublishDate: string;
      PrimaryURL: string;
      PkgName: string;
      Layer: {
        Digest: string;
        DiffID: string;
      };
      LastModifiedDate: string;
      InstalledVersion: string;
      FixedVersion: string;
      Description: string;
      Datasource: {
        ID: string;
        Name: string;
        URL: string;
      };
      CweIDs: string[];
      CVSS: {
        nvd: {
          V2Score: number;
          V2Vector: string;
          V3Score: number;
          V3Vector: string;
        };
        redhat: { V3Score: number; V3Vector: string };
      };
    }
  ];
};
